20.10.2 Creating a Swap File

The steps to create a swap file:

    Create a large file using the dd command. In order to determine which filesystem has room for the swap file, the df command was executed. The / filesystem has plenty of room, so the swap file was placed in the /var directory:

    root@localhost:~# df -h
    Filesystem      Size  Used Avail Use% Mounted on
    /dev/sda9        58G  7.7G   49G  14%
    tmpfs           7.9G     0  7.9G   0% /dev
    shm              64M     0   64M   0% /dev/shm
    /dev/sda9        58G  7.7G   49G  14% /etc/hosts
    root@localhost:~# dd if=/dev/zero of=/var/extraswap bs=1M count=100
    100+0 records in
    100+0 records out
    104857600 bytes (105 MB) copied, 0.320096 s, 328 MB/s

    Note that the resulting file is approximately 100MB in size, 100 blocks of 1MB in size. The options bs=100M and count=1 would have resulted in the same size. The file is full of binary zero values that came from the /dev/zero file. What is actually in the file doesn't really matter; the size of the file is what is important.

    Convert the file to swap space with the mkswap command:

    root@localhost:~# mkswap /var/extraswap
    Setting up swapspace version 1, size = 102396 KiB
    no label, UUID=908e51f8-a022-4508-8819-73e1d8837e2b

    Enable the file as current swap space with the swapon command:

    root@localhost:~# swapon /var/extraswap
    root@localhost:~# swapon -s
    Filename                                Type            Size    Used    Priority
    /devdm-1                                partition       1015800 0       -1
    /dev/sda3                               partition       102392  0       -2
    /var/extraswap                          file            102392  0       -3

